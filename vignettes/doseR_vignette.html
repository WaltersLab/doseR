<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="AV" />

<meta name="date" content="2019-02-11" />

<title>doseR</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">doseR</h1>
<h4 class="author"><em>AV</em></h4>
<h4 class="date"><em>2019-02-11</em></h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The doseR package aims to provide a consistent, efficient, and generalizable analytical framework for assessing sex chromosome dosage compensation using RNA-seq based read-count data. The study of sex chromosome dosage compensation has garnered increasing interest in the last 15 years or so. This growth has been driven in part by the rise of RNA-seq as a method for assaying genome-wide patterns of gene expression, along with the discovery of a surprising diversity of dosage compensation patterns across species. Yet despite the growing interest in the topic of dosage compensation, with many similarities among the analyses performed in various studies, each subsequent study tends to employ its own bespoke scripting to analyze and visualize the data. There has yet to emerge a common computational framework specifically developed to streamline and increase reproducibility among studies of dosage compensation. Our hope is for doseR to help fill that void.</p>
<p>Functions provided in doseR offer support for several analytical steps commonly done in studies of dosage compensation, including:</p>
<ul>
<li>Normalizing data relative to library size</li>
<li>Removing unexpressed or low-abundance transcripts</li>
<li>Visualizing absolute and relative expression levels across gene sets</li>
<li>Statistical comparisons between distributions of gene expressions</li>
</ul>
<p>Many of these elements may be of interest for studies of gene expression not specifically concerning dosage compensation, and the doseR package is not meant to be limited only to studies contrasting sex chromosomes versus autosomes or males versus females. doseR supports any number of comparisons between biological treatments and groupings of loci.</p>
</div>
<div id="overview" class="section level1">
<h1>Overview</h1>
<p>The standard goal of most sex chromosome dosage compensation studies is to assess whether the sex chromosome (i.e. the X or Z chromosome, depending on male or female heterogamety) shows a globally distinct pattern of gene expression between the sexes. On average, autosomal expression is expected to be comparable between the sexes because autosomes are diploid in both sexes. In contrast, differences in gene dose between the sexes due to heterogamety may influence average expression on the X or Z, depending on what compensating mechanisms have evolved. Thus most contemporary studies of sex chromosome dosage compensation proceed by using sex-specific RNA-seq data to compare distributions of normalized gene expression across chromosomes.</p>
<div id="inputs" class="section level2">
<h2>Inputs</h2>
<p>We assume users are starting with read count data from an RNA-seq experiment, as is typically generated after employing one of many commonly used alignment pipelines (e.g. RSEM, Salmon, etc). The doseR workflow starts with read count data, and not RPKM (or, comparably, FPKM), because RPKM values are calculated during the analysis after selecting the desired library-size normalization factor. RNA-seq data will typically come from distinct treatments (e.g. male, female) and may have one or more replicates per treatment. Users also provide lengths (in basepairs) for each transcript assayed. Finally, annotations indicating the groupings of loci (e.g. chromosome) are also needed.</p>
</div>
<div id="normalization" class="section level2">
<h2>Normalization</h2>
<p>Accounting for differences in library size (i.e. depth of sequencing) between samples is an important step in most statistical analyses involving RNA-seq data. doseR provides a variety of methods for defining the library size for each sample. After defining library sizes, read counts are scaled both by library size and transcript length to give RPKM values that can be meaningfully compared between loci and between samples.</p>
</div>
<div id="filtering" class="section level2">
<h2>Filtering</h2>
<p>One notable concern and potential artifact in dosage compensation analysis is the filtering of “unexpressed” loci. In theory, it is ideal to remove loci prior to analysis since we should be primarily concerned only with actively expressed genes. In practice, however, it is far from clear how best to do this or what criteria should be employed. When “unexpressed” loci are disproportionately represented among chromosomes (or other gene groups), failing to effectively remove them can cause spurious results. At the other extreme, overly aggressive removal of low-abundance transcripts can artificially compress distributions of gene expression, masking true differences in the data. A variety of approaches have been implement in doseR for filtering out loci considered to be “unexpressed”.</p>
</div>
<div id="comparing-absolute-expression" class="section level2">
<h2>Comparing absolute expression</h2>
<p>One informative way to assess dosage compensation is to consider the distribution of expression levels within sex between groups of genes, typically for genes on the X or Z versus the autosomes. This is done separately in each sex (or other treatments), providing a direct inference of absolute differences in gene expression among chromosomes (or other gene groupings). However, this approach is limited in that it does not easily support a direct comparison between sexes (or other treatments). doseR includes functions for visualization and statistical tests of differences in absolute gene expression.</p>
</div>
<div id="comparing-relative-expression" class="section level2">
<h2>Comparing relative expression</h2>
<p>Examining the distribution of expression ratios (e.g. Male:Female) between treatments across chromosomes (or other gene groupings) is an alternative approach to assess whether global expression biases exist for particular sets of genes, such as might be expected for uncompensated X or Z chromosomes. While this approach can provide nuanced assessment of dosage effects, it does not indicate what absolute changes in gene expression may be occurring that underlie shifts in expression ratio. doseR provides functions for visualizing and statistically testing variation in expression ratios across chromosomes (or other gene groupings), complementing functions for examining absolute differences in expression among groupings within treatment.</p>
<hr />
</div>
</div>
<div id="example-workflow" class="section level1">
<h1>Example workflow</h1>
<p>To demonstrate a typical workflow using doseR, we will use a subset of data from a study in <em>Heliconius</em> butterflies. <em>H. melpomene</em> has 20 autosomes with chromosome 21 being the “Z” sex chromosome.<br />
Like all Lepidoptera, this is a female-heterogametic species, so males are diploid for the Z while females have a single Z and W chromosomes. The relevant data are included in the doseR package, which must be installed.</p>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>If installing from a local file (i.e. a <em>tar.gz</em>), you simply give the path to the <code>install.packages</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">setwd</span>(<span class="st">&quot;~/Documents/doseR_Project/doseR_vignette&quot;</span>)
path.to.doser &lt;-<span class="st"> &quot;./doseR_1.4.0.tar.gz&quot;</span>
<span class="kw">install.packages</span>(<span class="dt">pkgs =</span> path.to.doser, <span class="dt">repos =</span> <span class="ot">NULL</span>, <span class="dt">type=</span><span class="st">&quot;source&quot;</span>, 
<span class="dt">lib =</span> <span class="kw">getwd</span>() )</code></pre></div>
<p>Alternatively (Eventually??), doseR can be installed from Bioconductor directly using the <code>BiocManager</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">&quot;BiocManager&quot;</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>))
    <span class="kw">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>)
BiocManager<span class="op">::</span><span class="kw">install</span>(<span class="st">&quot;doseR&quot;</span>)</code></pre></div>
<p>Once installed, you must load the package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(mclust)
<span class="co">#&gt; Package 'mclust' version 5.4.2</span>
<span class="co">#&gt; Type 'citation(&quot;mclust&quot;)' for citing this R package in publications.</span>
<span class="kw">library</span>(doseR)
<span class="kw">library</span>(edgeR)</code></pre></div>
</div>
<div id="example-data-heliconius-rna-seq" class="section level2">
<h2>Example data: <em>Heliconius</em> RNA-seq</h2>
<p>The primary data used by doseR are read counts from RNA-seq data, in this case generated from legs of <em>H. melpomene</em>, with three biological replicates each for male and female. Read count data should be formatted as a matrix, with replicates in columns and transcripts in rows. We also need a vector of corresponding transcript lengths. Finally, data indicating gene groupings are needed. Here we have a vector giving chromosomal linkage for each transcript (note that these data are limited to only one representative transcript per gene). These example data are included in the package as a list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#load(&quot;hmel.data.doser.Rdata&quot;) # loads hmel.dat</span>
<span class="kw">data</span>(hmel.data.doser)  <span class="co"># loads hmel.dat list</span>
<span class="kw">lapply</span>(hmel.dat, head)
<span class="co">#&gt; $readcounts</span>
<span class="co">#&gt;            HMP406_M HMP500_M HMP501_M HMP502_F HMP503_F HMP347_F</span>
<span class="co">#&gt; HMEL000002      142       68       16      414      119       69</span>
<span class="co">#&gt; HMEL000003        1        0        0        4        1        0</span>
<span class="co">#&gt; HMEL000004      217      175      168      490      528       40</span>
<span class="co">#&gt; HMEL000006       77      225       30     1602      503       99</span>
<span class="co">#&gt; HMEL000007        0        0        0        0        1        1</span>
<span class="co">#&gt; HMEL000008       50       37       13       79       32       52</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $trxLength</span>
<span class="co">#&gt; HMEL000002 HMEL000003 HMEL000004 HMEL000006 HMEL000007 HMEL000008 </span>
<span class="co">#&gt;       2702        933       2493       2549        769       3039 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $chromosome</span>
<span class="co">#&gt; [1] 15 15 15 15 15 15</span></code></pre></div>
<p>These three data elements are used to populate a new <code>countDat</code> object, which is the core data structure for the doseR package. This object contains and organizes the read counts, RPKM values, segment lengths, and annotations of gene groupings. However, there are some further data manipulations required before we can create a new <code>countDat</code>object.</p>
<p>First, we need to create a vector indicating to the replicate structure in the data, in this case three male and three female replicates, as organized in the counts matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reps &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Female&quot;</span>)</code></pre></div>
<p>Second, we must create a dataframe to hold the annotation of gene groupings. In doing this, we will also convert the numeric <code>hmel.dat$chromosome</code> vector into a factor, which facilitates proper ordering of gene groups in later plotting. Additionally, we will recode the chromosomal linkage information as being Z-linked or autosomal.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">annotxn &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;Chromosome&quot;</span> =<span class="st"> </span><span class="kw">factor</span>(hmel.dat<span class="op">$</span>chromosome, 
<span class="dt">levels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">21</span>))
annotxn<span class="op">$</span>ZA &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>(hmel.dat<span class="op">$</span>chromosome <span class="op">==</span><span class="st"> </span><span class="dv">21</span>, <span class="st">&quot;Z&quot;</span>, <span class="st">&quot;A&quot;</span>), 
<span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;Z&quot;</span>))</code></pre></div>
<p>Now we are ready to populate a new <code>countDat</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hmel.cd &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;countDat&quot;</span>, <span class="dt">data =</span> hmel.dat<span class="op">$</span>readcounts, 
<span class="dt">replicates =</span> reps, <span class="dt">seglens =</span> hmel.dat<span class="op">$</span>trxLength, <span class="dt">annotation =</span> annotxn)

hmel.cd
<span class="co">#&gt; An object x of class &quot;countDat&quot;</span>
<span class="co">#&gt; 13619 rows and 6 columns</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot &quot;replicates&quot;</span>
<span class="co">#&gt; Male Male Male Female Female Female</span>
<span class="co">#&gt; Slot &quot;data&quot;:</span>
<span class="co">#&gt;            HMP406_M HMP500_M HMP501_M HMP502_F HMP503_F HMP347_F</span>
<span class="co">#&gt; HMEL000002      142       68       16      414      119       69</span>
<span class="co">#&gt; HMEL000003        1        0        0        4        1        0</span>
<span class="co">#&gt; HMEL000004      217      175      168      490      528       40</span>
<span class="co">#&gt; HMEL000006       77      225       30     1602      503       99</span>
<span class="co">#&gt; HMEL000007        0        0        0        0        1        1</span>
<span class="co">#&gt; 13614 more rows...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot &quot;RPKM&quot;:</span>
<span class="co">#&gt; numeric(0)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot &quot;annotation&quot;:</span>
<span class="co">#&gt;   Chromosome ZA</span>
<span class="co">#&gt; 1         15  A</span>
<span class="co">#&gt; 2         15  A</span>
<span class="co">#&gt; 3         15  A</span>
<span class="co">#&gt; 4         15  A</span>
<span class="co">#&gt; 5         15  A</span>
<span class="co">#&gt; 13614 more rows...</span></code></pre></div>
</div>
<div id="normalization-rpkm" class="section level2">
<h2>Normalization &amp; RPKM</h2>
<p>Next we select a method for calculating the library size (sometimes called <em>scaling factors</em>) so that data are normalized for depth of sequencing. Various methods for calculating a library size are provided, but we will use the most straightforward method of summing total read counts.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">libsizes</span>(hmel.cd) &lt;-<span class="st"> </span><span class="kw">getLibsizes2</span>(hmel.cd, <span class="dt">estimationType =</span> <span class="st">&quot;total&quot;</span>)
<span class="kw">libsizes</span>(hmel.cd)
<span class="co">#&gt; HMP406_M HMP500_M HMP501_M HMP502_F HMP503_F HMP347_F </span>
<span class="co">#&gt;  3819450  2023213   995423  7272911  5007955  3391271</span></code></pre></div>
<p>With library sizes now stored in the <code>countDat</code> object, we can calculate RPKM values for each locus in each sample and store them in the <span class="citation">@RPKM</span> slot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rpkm</span>(hmel.cd) &lt;-<span class="st"> </span><span class="kw">make_RPKM</span>(hmel.cd)
hmel.cd
<span class="co">#&gt; An object x of class &quot;countDat&quot;</span>
<span class="co">#&gt; 13619 rows and 6 columns</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot &quot;replicates&quot;</span>
<span class="co">#&gt; Male Male Male Female Female Female</span>
<span class="co">#&gt; Slot &quot;data&quot;:</span>
<span class="co">#&gt;            HMP406_M HMP500_M HMP501_M HMP502_F HMP503_F HMP347_F</span>
<span class="co">#&gt; HMEL000002      142       68       16      414      119       69</span>
<span class="co">#&gt; HMEL000003        1        0        0        4        1        0</span>
<span class="co">#&gt; HMEL000004      217      175      168      490      528       40</span>
<span class="co">#&gt; HMEL000006       77      225       30     1602      503       99</span>
<span class="co">#&gt; HMEL000007        0        0        0        0        1        1</span>
<span class="co">#&gt; 13614 more rows...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot &quot;RPKM&quot;:</span>
<span class="co">#&gt;              HMP406_M HMP500_M  HMP501_M   HMP502_F   HMP503_F   HMP347_F</span>
<span class="co">#&gt; HMEL000002 13.7594847 12.43890  5.948767 21.0671954  8.7942984  7.5301088</span>
<span class="co">#&gt; HMEL000003  0.2806193  0.00000  0.000000  0.5894814  0.2140218  0.0000000</span>
<span class="co">#&gt; HMEL000004 22.7895960 34.69558 67.698545 27.0249892 42.2913186  4.7312426</span>
<span class="co">#&gt; HMEL000006  7.9089724 43.62858 11.823437 86.4140586 39.4037660 11.4525676</span>
<span class="co">#&gt; HMEL000007  0.0000000  0.00000  0.000000  0.0000000  0.2596649  0.3834521</span>
<span class="co">#&gt; 13614 more rows...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot &quot;annotation&quot;:</span>
<span class="co">#&gt;   Chromosome ZA</span>
<span class="co">#&gt; 1         15  A</span>
<span class="co">#&gt; 2         15  A</span>
<span class="co">#&gt; 3         15  A</span>
<span class="co">#&gt; 4         15  A</span>
<span class="co">#&gt; 5         15  A</span>
<span class="co">#&gt; 13614 more rows...</span></code></pre></div>
<p>It is always wise when first working with comparisons between genome-wide expression data sets like this to check that there are not clear biases or other artifacts showing up in the data, and that the normalization seems reasonable. Making <a href="https://en.wikipedia.org/wiki/MA_plot">MA plots</a> is one important visualization to guard agains such problems.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotMA.CD</span>(<span class="dt">cD =</span> hmel.cd, <span class="dt">samplesA =</span><span class="st">&quot;Male&quot;</span>, <span class="dt">samplesB =</span> <span class="st">&quot;Female&quot;</span>, <span class="dt">cex =</span> .<span class="dv">2</span> , 
<span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, .<span class="dv">2</span>), <span class="dt">xlab =</span> <span class="st">&quot;Log2(Average RPKM)&quot;</span>, 
<span class="dt">ylab =</span> <span class="st">&quot;Log2(Male:Female)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="filtering-unexpressed-loci" class="section level2">
<h2>Filtering “unexpressed” loci</h2>
<p>It is generally good practice to remove loci considered to be “unexpressed”. In this case we will apply a filter so that included loci must have a mean RPKM value across samples greather than 0.01. Many other approaches to filtering are provided in doseR, and it is generally wise to explore how filtering choices affect assessments of dosage compensation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hmel.filt &lt;-<span class="st"> </span><span class="kw">simpleFilter</span>(<span class="dt">cD =</span> hmel.cd, <span class="dt">mean_cutoff =</span> <span class="fl">0.01</span>, <span class="dt">counts =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; Filtering removed 4035 (29.63%)</span>
<span class="co">#&gt; of 13619 total loci.</span></code></pre></div>
</div>
<div id="comparing-absolute-expression-1" class="section level2">
<h2>Comparing absolute expression</h2>
<p>Having generated filtered RPKM values, we can proceed to comparing distributions of expression among different groupings of genes, as indicated in the <code>@annotation</code> slot of the <code>countDat</code> object. Biological replicates are averaged to give a single representative RPKM value per gene. In this case it is clear that the gene expression is reduced on the Z chromosome relative to autosomes in both sexes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotExpr</span>(<span class="dt">cD =</span> hmel.filt, <span class="dt">groupings =</span> <span class="st">&quot;ZA&quot;</span>, <span class="dt">clusterby_grouping =</span> <span class="ot">FALSE</span>, 
<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;grey80&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;grey80&quot;</span>,<span class="st">&quot;red&quot;</span>), <span class="dt">notch=</span><span class="ot">TRUE</span>, <span class="dt">ylab =</span> <span class="st">&quot;Log2(RPKM)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Beyond visualizing with boxplots, we will also want statistical summaries and tests applied to these data, which can be done with the <code>generateStats()</code> function. Here we will want to subset the <code>countDat</code> object so that tests are applied using only data from a single treatment. The function returns a list of three items:</p>
<ol style="list-style-type: decimal">
<li>A distributional summary for each grouping of genes analyzed</li>
<li>The results from applying a Kruskal-Wallis test, a non-parametric test of differences among groups</li>
<li>The values used for generating 1 &amp; 2, i.e. the average values across replicates for each gene in each group.</li>
</ol>
<p>Here we demonstrate this only for male samples, but a full analysis would also require the same be done for the female samples.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hmel.male &lt;-<span class="st"> </span>hmel.filt[, <span class="kw">replicates</span>(hmel.filt) <span class="op">==</span><span class="st"> &quot;Male&quot;</span>]
male_ZvA &lt;-<span class="st"> </span><span class="kw">generateStats</span>(<span class="dt">cD =</span> hmel.male , <span class="dt">groupings =</span> <span class="st">&quot;ZA&quot;</span>, <span class="dt">LOG2 =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; View output: outlist$kruskal, outlist$summary</span>
male_ZvA<span class="op">$</span>summary  <span class="co"># distributional summary statistics</span>
<span class="co">#&gt;                    A           Z</span>
<span class="co">#&gt; Min.        0.000000    0.000000</span>
<span class="co">#&gt; 1st Qu.     1.837499    1.093565</span>
<span class="co">#&gt; Median      8.715750    5.795021</span>
<span class="co">#&gt; Mean       54.737996   37.759261</span>
<span class="co">#&gt; 3rd Qu.    23.573567   16.577152</span>
<span class="co">#&gt; Max.    20065.669794 4351.420842</span>
male_ZvA<span class="op">$</span>kruskal  <span class="co"># htest class output from kruskal.test()</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Kruskal-Wallis rank sum test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  tmp</span>
<span class="co">#&gt; Kruskal-Wallis chi-squared = 19.006, df = 1, p-value = 1.303e-05</span>
<span class="kw">lapply</span>(male_ZvA<span class="op">$</span>data, head) <span class="co"># a record of values used for statistics.</span>
<span class="co">#&gt; $A</span>
<span class="co">#&gt;  HMEL000002  HMEL000003  HMEL000004  HMEL000006  HMEL000007  HMEL000008 </span>
<span class="co">#&gt; 10.71571713  0.09353976 41.72790716 21.12032979  0.00000000  4.87423582 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Z</span>
<span class="co">#&gt; HMEL002056 HMEL002096 HMEL002142 HMEL002143 HMEL002145 HMEL002156 </span>
<span class="co">#&gt;  4.9311162  0.4912925 27.8965294  6.1170531  1.8668670 99.4424234</span></code></pre></div>
<p>It may be of interest to examine other groupings of genes. For instance, how variable are the distributions of expression across chromosomes?<br />
Again, we’ll limit this only to males for the sake of demonstration.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotExpr</span>(<span class="dt">cD =</span> hmel.filt, <span class="dt">groupings =</span> <span class="st">&quot;Chromosome&quot;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;grey80&quot;</span>, <span class="dv">20</span>), 
<span class="st">&quot;red&quot;</span>), <span class="dt">notch=</span><span class="ot">TRUE</span>, <span class="dt">ylab =</span> <span class="st">&quot;Log2(RPKM)&quot;</span>, <span class="dt">las =</span> <span class="dv">2</span>, <span class="dt">treatment =</span> <span class="st">&quot;Male&quot;</span>,  
<span class="dt">clusterby_grouping =</span> <span class="ot">TRUE</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="comparing-relative-expression-1" class="section level2">
<h2>Comparing relative expression</h2>
<p>Similarly to the plots and statistics given above for <em>absolute</em> expression, doseR provides functions for examing <em>relative</em> expression between pairs of treatments. For instance, we may want to assess whether there is a dosage effect on gene expression for the Z chromosome. This would manifest as a positive shift in the distribution of Male:Female expression levels on the Z relative to autosomes.</p>
<p>We can examine this using boxplots, similar to absolute expression, above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotRatioBoxes</span>(<span class="dt">cD =</span> hmel.filt, <span class="dt">groupings =</span> <span class="st">&quot;ZA&quot;</span>, <span class="dt">treatment1 =</span> <span class="st">&quot;Male&quot;</span>, 
<span class="dt">treatment2 =</span> <span class="st">&quot;Female&quot;</span>, <span class="dt">outline =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;grey80&quot;</span>, <span class="st">&quot;red&quot;</span>),
<span class="dt">ylab =</span> <span class="st">&quot;Log(Male:Female)&quot;</span> )</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Alternatively, there is a widely used convention in the dosage compensation literature to visualize these distributions using a density plot, so this functionality is also provided.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotRatioDensity</span>(<span class="dt">cD =</span> hmel.filt, <span class="dt">groupings =</span> <span class="st">&quot;ZA&quot;</span>, <span class="dt">treatment1 =</span> <span class="st">&quot;Male&quot;</span>, 
<span class="dt">treatment2 =</span> <span class="st">&quot;Female&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Log(Male:Female)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Density&quot;</span>)
<span class="co">#&gt; Current order of levels:  A Z</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEgCAMAAABb4lATAAAAb1BMVEUAAAAAADoAAGYAOjoAOpAAZmYAZrY6AAA6ADo6AGY6kNtmAABmADpmAGZmZgBmkJBmtrZmtv+QOgCQOjqQZgCQkGaQ2/+2ZgC2tma225C2/7a2/9u2///bkDrb////AAD/tmb/25D//7b//9v///9Hs8tnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKyUlEQVR4nO2di3qruBVGyZk0mYmnndptQy/DAV/e/xmLEMZgI0DbEmL//tf3HTuHWEhoRVeQnF0INFnqBJC4UDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweAEFpyRlUglOOzpiAsKBoeCwVlZsH/TkBo1CXXAEjyDnj/FcSh4mkxNSh1Q8CTZRU1SHVDwJBQcPd60UHD0eNNCwdHjTUvWvWiFgieh4OjxpiXrveqEgqfIBm8qiSQ4z7KP8yHLsn2Q06WCgh0U7z9rxx+Xy2n3FeB0yaDgcc6HWmv19n2xqp89XTooeJzTrq6Zqx9/Xq6vz50uHRQ8DkoJzh5+0EfkNrhR/fTpUtEXXKZMyBOwFz3BoAQrNcxx8ARdIssLBceKNyUDwUoNxxZcaO5FDwXrhA/dTXBNZKkiteOwip6Aw6QV4k1JNvxJZUUdSXAzRKpxtMAUvBqRJjqydn6jyhRPdPT6WFn7rg9/waedmaKapDd/pXmq8kUFm/KZuQqmpbnZYNF8s6HrRHc/KzQsrKKnHYOV4PKiI72jiNvgYqoLVVznoDW3wZnzP5qQCa6a2wjng6N4Ng11g/MDCjLsZQUbeVacq4ENGW86+jX0K7XBp11zJ3+teNPxsoJ/t36fKL4+8aZjRLBCw3LBrvtEgeNNx2sKzm/3gyaHwsHiTceYYH2G5SV4pXjTkU38Tw+8m+SEgleJNxnZ5H/V4Cn4tPu6zmG457GCxpuMu1ZXay+LJdjFfbdK6UiYz2Q5eOg2Ky3CoqnKL3OrwTnNHDbeVLyw4Pz95/Hz45LP3fYPE28qHhK4+RSPI5mL3l+qbI8+VfnagvNaLvhUpVOwsjpaUkV/nHbvP0+716iiy/sj+ILrgfDb9/nwlN/NC+49cHd3CF/wuvEmYqRCpuAo8aZhpAArneoQCJ5dtRA03jSM9qg2nuZxJJ2sp8z6xpuG0eRtPM3jSIZJi+/0Hz9dOzhsPbOmBOuqo2Xj4Bm6G07uipyCV8Jf8JIBUvu8u/4SPNoGqzIsaIMr59Y5N8xUiGLBo51onUVYUkUvuuGfv33rF1yOH9ZEvHFwkX1RcHoiTnQcP39RKtjZ2G461eNIBNeV9PvPfH6wdD64W+tNZ5UzcQrnsiSdrLfvwtxNwn3w/bUFm9XdZln3svvBKjdCmxGsyrBsosMIFj3RoeOhu7k2GFvwtQTnTz11p0Hwo8dNp3occRtcLJjuCBFvAtwzVltOtQNhLzrLpleBq94IbaIi1ldHxxkH694IjYLnUL6N0kTaXkGwnYue7GEp3whtKm3qRsLegnPbuSqmFvhDlOBxieqKsK/g6tq5mriRoH0jtCZtDoVbTvconoJ7d/sn1yZp3ghtshbecLrH8RTcm4GGXbry4oJnu0+B412d6ZSht8EvL1idYQq+Z6qLdaHg4PGujknZhD5tj1Z6C5594jlwvGsz43fDKR8n4jNZa54uHBS8crwrM5+urabcAQUPWS5YSSNMwUNma+hbynUYpuAB8361FeGVBW/8obslfik4xekCsUjwRtPugIJ7LEzUJtPugoJ7+ArWUElT8I1lFfRFVytMwTcWC9ZkmII7Zm4jPXx0+cdTQsFXPPxuMfkuKNjiOzLf6ED+EQpuyLzK7y3E9ivpSIJVrU0qy7J79cD/jyIFcQSrWptUltLEWMPbVhxFsLKVDfK0KGiJowhWtDapfPK+RxPau3ZfkZcuwVkIMa3iS9ccl+WWhMdqgze+NskoyLJAGmwdkN2V5I1IjtSL3vjapNJ73DuJvcH9cMpNKH6dcbDJ7qypPuM9b7DBBxmQBI82faUtX9ZrhEjvyYYPrSQvxbEFr7YRWtm9ljaXr4XVak9RtqxlW2MkK9rbeCarJ0P63is5W+rE2r+sANfn8z6If3FCA1932NMRFxQMDm82gMObDeAkm6okKxFDsNcycWFZXjUYcBpF4ReUYNmJUwUDTqMs/PzNBuGJEwUDTqMw/OzNBumJ0wQDTmOw8KFPrCHzNKQxWPjQJ9aQeRrSGCx86BNryDwNaQwWPvSJNWSehjQGCx/6xBoyT0Mag4UnG4eCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBiea4ONnlk19DaKbfMEDQXc0D+TPPiY2pJr7uvNgMbUIrkueiR2xBFf11Zx2ksRVS574GnI+1KoKv6ww37daeRuWxHSN0P+65Jl4I5Jg+4St5IsuTzv/jLDfiesVm03g5FetBoqpRXBd8kzsEUnw8Vf/2s9SvP/Tvypr8CqPclO+MbUIrkueiT0iCa5+/HcnaqvqixK0VQ25jy2becLv8fOKqYvP+7rEmdgnkuDCLEDsfe30UkytJBS84GH8/qebQigpir4xNYiuS5qJA2IJfpMVELMkRia48u9jCQV7xtQgui5pJg6IJbhJlW3oPGgqTpFg31Ilr6IF5Vd4XcJMHBJecGEGijbnfHoJTbCiXRu5/JIKOywtfHNd3MnyjskG8r0ug38mjhCpBNuVprLaRVCCC8+sEw+TBDF1eF/XM5nYEWuiwzQ6veWmPvgLPn76RySb6JDEdMX/up7IxI5oU5XVilN6bQ3op6uQTFWKYmoR1EzyTOzgzQZwKBgcCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgYHQvDUqp/zYX8+tAt8Bhvd9L5qsz3LwjWe/YCn3wNsoxEVeMHFh9nbyn4gnxa8cHHYIGAl3FBkNdAFGxvnw1+agnb669+CC64rCK+krg6Y4G69ZV3fvv3LLAG2+5jk5mBldzLKbTXceGo3CGh2OukJbg8fP/9utrkx+83tL6MBl3zRblqwBFe1gGZrOLPRUWWW8Zo1/LW+pibNv8wHzRGzvYnxZN67Nd03wdfDx89mX7v6XGavh/GAso161gNKsF0NX2e53YEjf/s+7Wz5PP72p+kQ1R9sukXm97Wn5rfdHgmd4O5wo7B92TsCPrlHSnSgBNvMrl+ts8oI3jeCTVNZl+L2g1XWlPS9LX1XRfm1E90dbn5zexkNaF1vF0DBtYDiKrg5YlrYujOd273I6tbzx39sQawGA6NeRd8eHgoeD0jBKzBfgi/H3/73j2/zwc5XVxDvz3JrVgeCHQEpeAUcbXBxa4Prf3/UzXD9wca97YzthyOlXhvcHh4IdgRkG7wC871o08LakZAtg/UQ59oZNn2x4Vm6ww8leCQge9Er0HaPvobj4B//Npav+3ka99c2+O07b2tvM5y9fuJuHFwffmiDHwJyHJwSI/dhviowsc//NJiCewOY4snvPJiBc9FpqLrRT9zJYt5NIomhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LB+T+Cm5Nu6WC5FQAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>As above, we can apply the same plotting to the chromosomal annotation if desired.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">plotRatioBoxes</span>(<span class="dt">cD =</span> hmel.filt, <span class="dt">groupings =</span> <span class="st">&quot;Chromosome&quot;</span>, <span class="dt">treatment1 =</span>
<span class="st">&quot;Male&quot;</span>, <span class="dt">treatment2 =</span> <span class="st">&quot;Female&quot;</span>, <span class="dt">outline =</span> <span class="ot">FALSE</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;grey80&quot;</span>, <span class="dv">20</span>), 
<span class="st">&quot;red&quot;</span>), <span class="dt">ylab =</span> <span class="st">&quot;Log(Male:Female)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Chromosome&quot;</span> )

<span class="kw">plotRatioDensity</span>(<span class="dt">cD =</span> hmel.filt, <span class="dt">groupings =</span> <span class="st">&quot;Chromosome&quot;</span>, <span class="dt">treatment1 =</span> 
<span class="st">&quot;Male&quot;</span>, <span class="dt">treatment2 =</span> <span class="st">&quot;Female&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Log(Male:Female)&quot;</span>,
<span class="dt">ylab =</span> <span class="st">&quot;Density&quot;</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;grey80&quot;</span>, <span class="dv">20</span>), <span class="st">&quot;red&quot;</span>), <span class="dt">lty =</span> <span class="dv">1</span>)
<span class="co">#&gt; Current order of levels:  15 18 21 13 7 19 8 3 11 16 9 1 17 6 20 10 5 12 4 14 2</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Beyond plotting, we also want to know whether there are statistical differences between the groupings indicated. The <code>test_diffs()</code> function summarizes the distributions of expression ratios among groups and applies a non-parametric Kruskal-Wallis test.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">za.ratios.test &lt;-<span class="st"> </span><span class="kw">test_diffs</span>(<span class="dt">cD =</span> hmel.filt, <span class="dt">groupings =</span> <span class="st">&quot;ZA&quot;</span>, 
<span class="dt">treatment1 =</span> <span class="st">&quot;Male&quot;</span>, <span class="dt">treatment2 =</span> <span class="st">&quot;Female&quot;</span>, <span class="dt">LOG2 =</span> <span class="ot">FALSE</span> )
<span class="co">#&gt; View output: outlist$kruskal, outlist$summary</span>
za.ratios.test<span class="op">$</span>summary  <span class="co"># summary statistics for each grouping</span>
<span class="co">#&gt;                   A          Z</span>
<span class="co">#&gt; Min.      0.0000000  0.0000000</span>
<span class="co">#&gt; 1st Qu.   0.6788987  0.7821321</span>
<span class="co">#&gt; Median    0.8677571  1.0212513</span>
<span class="co">#&gt; Mean      0.9956633  1.1136910</span>
<span class="co">#&gt; 3rd Qu.   1.0628770  1.2781894</span>
<span class="co">#&gt; Max.     81.7647412  7.6471211</span>
<span class="co">#&gt; NA's    211.0000000 19.0000000</span>
za.ratios.test<span class="op">$</span>kruskal  <span class="co"># htest class output from kruskal.test()</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Kruskal-Wallis rank sum test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  tmp</span>
<span class="co">#&gt; Kruskal-Wallis chi-squared = 65.132, df = 1, p-value = 7.003e-16</span>
<span class="kw">lapply</span>(za.ratios.test<span class="op">$</span>data, head) <span class="co"># values used for summaries and tests</span>
<span class="co">#&gt; $A</span>
<span class="co">#&gt; HMEL000002 HMEL000003 HMEL000004 HMEL000006 HMEL000007 HMEL000008 </span>
<span class="co">#&gt;  0.8597425  0.3492448  1.6905856  0.4615780  0.0000000  1.3637461 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Z</span>
<span class="co">#&gt; HMEL002056 HMEL002096 HMEL002142 HMEL002143 HMEL002145 HMEL002156 </span>
<span class="co">#&gt;  1.0500235  3.9418081  1.2663384  1.0861082  0.6493254  1.6593288</span></code></pre></div>
</div>
<div id="workflow-conclusion" class="section level2">
<h2>Workflow conclusion</h2>
<p>As can be seen from these plots and statistics, these data reveal a distinct reduction in absolute expression for Z linked loci, relative to autosomes, for both sexes. Furthermore, there is a modest but statistically significant dosage effect causing a male-bias in the male:female ratio expression on the Z chromosome. The functions support various comparisons between treatments and among any set of gene groupings, as specified in the annotations.</p>
<p>In some cases, when analyzing more than two gene groupings (e.g. across individual chromosomes), users may want to extend statistical analyses to specific pairwise comparisons. For instance, is the average Z expression specifically different from chromosome 14 in particular? Because the Kruskal-Wallis test is a “global” test for inequality among groups (analogous to an ANOVA), you may want to apply a follow-up non-parametric post-hoc test for specific pairwise comparisons after a significant Kruskal-Wallis test. Several such tests, such as the <a href="https://en.wikipedia.org/wiki/Nemenyi_test"><em>Nemenyi</em></a>, are implemented in the [PMCMRplus] (<a href="https://cran.r-project.org/web/packages/PMCMRplus/index.html" class="uri">https://cran.r-project.org/web/packages/PMCMRplus/index.html</a>) package.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
